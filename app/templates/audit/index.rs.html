@use super::super::layout_html;
@use crate::layout::SideBar;
@use super::action_html;
@use super::client_html;
@use crate::cornucopia::queries::audit::Audit;
@use time::format_description::well_known::Rfc3339;

@(audits: Vec<Audit>)

@:layout_html("Audit Trail", {
    <div class="m_card">
        <div class="header">
            <span>Audit Trail</span>
        </div>
        <div class="body">
            <table class="m_table team_table">
                <thead>
                    <tr>
                        <th>When</th>
                        <th>User</th>
                        <th>Access Type</th>
                        <th>Action</th>
                        <th>Description</th>
                    </tr>
                </thead>
                <tbody>
                    @for audit in audits {
                        <tr>
    
                            <td>
                                <relative-time datetime="@audit.created_at.format(&Rfc3339).unwrap()"></relative-time>
                            </td>
                            <td>
                                @audit.user_id
                            </td>
                            <td>
                                @:client_html(audit.access_type)
                            </td>
                            <td>
                                @:action_html(audit.action)
                            </td>
                            <td>
                                @audit.description
                            </td>
                        </tr>
                    }
                </tbody>
            </table>
        </div>
    </div>
}, {
}, None, SideBar::Audit)